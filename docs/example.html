<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Forms in Centered Modals</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Inline minimal CSS (no external file needed) -->
  <style>
    :root { --backdrop: rgba(0,0,0,.6); }
    body { font-family: system-ui, sans-serif; margin: 0; padding: 2rem; }
    button { padding: .6rem 1rem; margin-right: .5rem; cursor: pointer; }

    /* Backdrop + centering */
    .modal {
      position: fixed; inset: 0;
      display: none; /* hidden by default */
      align-items: center; justify-content: center; /* center content */
      background: var(--backdrop);
      padding: 2rem; /* breathing room on small screens */
      z-index: 9999;
    }
    .modal.open { display: flex; }

    /* The dialog panel */
    .modal-content {
      background: #fff;
      width: min(95vw, 900px);
      height: min(90vh, 1000px);
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
      position: relative;
      overflow: hidden; /* clip iframe corners */
      display: flex; flex-direction: column;
    }

    /* Close button (accessible name is provided via aria-label) */
    .close-button {
      position: absolute; top: .5rem; right: .75rem;
      font-size: 1.75rem; line-height: 1; cursor: pointer; user-select: none;
    }

    /* Iframe fills the panel */
    .modal-content iframe {
      width: 100%;
      height: 100%;
      border: 0;
      display: block;
    }
  </style>
</head>
<body>
  <button id="openGoogleForm">Open Google Form</button>
  <button id="openOfficeForm">Open Office Form</button>

  <!-- Google Form Modal -->
  <div id="googleFormModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="g-title">
    <div class="modal-content" role="document">
      <span class="close-button" role="button" aria-label="Close dialog">&times;</span>
      <iframe
        id="googleFormFrame"
        title="Google Form"
        loading="lazy"
        data-src="https://docs.google.com/forms/d/e/1FAIpQLSd2Z21O_d7TzM_JcSWm5w6Q6Iw2CNTpclhHvRlM3kw9TwpSXA/viewform?embedded=true">
      </iframe>
    </div>
  </div>

  <!-- Office Form Modal -->
  <div id="officeFormModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="o-title">
    <div class="modal-content" role="document">
      <span class="close-button" role="button" aria-label="Close dialog">&times;</span>
      <iframe
        id="officeFormFrame"
        title="Microsoft Office Form"
        loading="lazy"
        allowfullscreen webkitallowfullscreen mozallowfullscreen msallowfullscreen
        data-src="https://forms.office.com/Pages/ResponsePage.aspx?id=DQSIkWdsW0yxEjajBLZtrQAAAAAAAAAAAAMAAMVhoodUNE1XSllVUUJOWlpNVFMySjNZRUNZWjUzUC4u&embed=true">
      </iframe>
    </div>
  </div>

  <script>
    // Grab elements
    const googleModal = document.getElementById('googleFormModal');
    const officeModal = document.getElementById('officeFormModal');

    const openGoogleBtn = document.getElementById('openGoogleForm');
    const openOfficeBtn = document.getElementById('openOfficeForm');

    const googleFrame = document.getElementById('googleFormFrame');
    const officeFrame = document.getElementById('officeFormFrame');

    // Utility: lazy-load iframe src on first open
    function ensureIframeLoaded(iframeEl) {
      if (!iframeEl.src) {
        const url = iframeEl.getAttribute('data-src');
        if (url) iframeEl.src = url;
      }
    }

    // Open/close helpers
    function openModal(modalEl, iframeEl) {
      ensureIframeLoaded(iframeEl);
      modalEl.classList.add('open');
      document.body.style.overflow = 'hidden'; // prevent background scroll
    }

    function closeModal(modalEl) {
      modalEl.classList.remove('open');
      // If no modals remain open, restore scroll
      if (![...document.querySelectorAll('.modal')].some(m => m.classList.contains('open'))) {
        document.body.style.overflow = '';
      }
    }

    // Open buttons
    openGoogleBtn.addEventListener('click', () => openModal(googleModal, googleFrame));
    openOfficeBtn.addEventListener('click', () => openModal(officeModal, officeFrame));

    // Close when clicking the "X"
    for (const btn of document.querySelectorAll('.close-button')) {
      btn.addEventListener('click', (e) => {
        const modal = e.target.closest('.modal');
        if (modal) closeModal(modal);
      });
    }

    // Close when clicking outside the panel (on the backdrop)
    function backdropCloseHandler(e) {
      if (e.target === e.currentTarget) closeModal(e.currentTarget);
    }
    googleModal.addEventListener('click', backdropCloseHandler);
    officeModal.addEventListener('click', backdropCloseHandler);

    // Close on Escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (googleModal.classList.contains('open')) closeModal(googleModal);
        if (officeModal.classList.contains('open')) closeModal(officeModal);
      }
    });
  </script>
</body>
</html>
